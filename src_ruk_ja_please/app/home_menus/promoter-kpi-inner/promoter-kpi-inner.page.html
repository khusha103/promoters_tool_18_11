<ion-header [translucent]="true" class="custom-border-header">
  <ion-toolbar class="maincontainer">
    <ion-grid>
      <ion-row class="toolbar-row">
        <ion-col size="4" class="toolbar-col">
          <a href="#" class="back_link">
            <ion-icon name="chevron-back-outline" class="back-button" [routerLink]="['/promoter-kpi']"></ion-icon>
          </a>
        </ion-col>
        <ion-col size="4" class="toolbar-col second_col_img">
<img src="/assets/icon/homeicons/sony_light.svg" alt="" class="SONY_mail_logo dark_pta">
          <img src="/assets/icon/homeicons/sony_dark.svg" alt="" class="SONY_mail_logo light_pta">        </ion-col>
        <ion-col size="4" class="toolbar-col">
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-toolbar>
</ion-header>

<!-- <ion-content class="main-content">
  <div class="heading-div">
    <h6 class="home-headings">Promoter KPI</h6>
  </div>
  <ion-grid class="pprofile-grid">
    <ion-row class="pprofile-details-row">
      <ion-col size="4" class="ddetail-heading">
        <p>Name:</p>
      </ion-col>
      <ion-col size="8" class="ddetail-text">
        {{ userData.firstName }} {{ userData.lastName }}
      </ion-col>
    </ion-row>

    <ion-row class="pprofile-details-row">
      <ion-col size="4" class="ddetail-heading">
        <p>Retailer:</p>
      </ion-col>
      <ion-col size="8" class="ddetail-text">
        {{ userData.retailerName }}
      </ion-col>
    </ion-row>

    <ion-row class="pprofile-details-row">
      <ion-col size="4" class="ddetail-heading">
        <p>Store:</p>
      </ion-col>
      <ion-col size="8" class="ddetail-text">
        {{ userData.storeName }}
      </ion-col>
    </ion-row>

    <ion-row class="pprofile-details-row">
      <ion-col size="4" class="ddetail-heading">
        <p>Category:</p>
      </ion-col>
      <ion-col size="8" class="ddetail-text">
        {{ userData.categories }}
      </ion-col>
    </ion-row>

    <ion-row class="pprofile-details-row">
      <ion-col size="4" class="ddetail-heading">
        <p>Country:</p>
      </ion-col>
      <ion-col size="8" class="ddetail-text">
        {{ userData.country }}
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-grid>
    <ion-row>
      <ion-col size="12" class="ion-text-center"> 
        <ion-button expand="full" class="tick" (click)="openMonthSelect()">
          {{ selectedMonth ? selectedMonth : 'Select Month' }}
        </ion-button>
      </ion-col>
    </ion-row>
  </ion-grid>

 
  <ion-select #monthSelect interface="popover" placeholder="Select Month" (ionChange)="onMonthSelect($event)"
    label="Select Month:" class="mine" multiple="true">
    <ion-select-option *ngFor="let month of months" [value]="month.value">{{ month.name }}</ion-select-option>
  </ion-select>

  
  <div class="table-container">
    <table class="custom-table">
      
      <thead>
        <tr class="tableheadingcss">
          <th>Mon</th>
          <th>Exam</th>
          <th>VMD</th>
          <th>Sales</th>
          <th>TTL</th>
        </tr>
      </thead>

      <tbody class="tablebodycss">
        <tr *ngFor="let score of kpiScores">
          <td>{{ getMonthName(score.month) }}</td>
          <td>{{ score.exam_weight !== null && score.exam_weight !== undefined ? score.exam_weight + '%' : 'N/A' }}</td>
          <td>{{ score.vmd_weight !== null && score.vmd_weight !== undefined ? score.vmd_weight : 'N/A' }}</td>
          <td>{{ score.sales_weight !== null && score.sales_weight !== undefined ? score.sales_weight + '%' : 'N/A' }}</td>
          <td>{{ score.ttl_ranking !== null && score.ttl_ranking !== undefined ? score.ttl_ranking + '%' : 'N/A' }}</td>
        </tr>
        <tr>
          <td>TTL</td>
          <td></td>
          <td></td>
          <td></td>
          <td><strong>{{ totalTtlPercentage }}%</strong></td> 
        </tr>
      </tbody>


    </table>
  </div>


  <ion-button expand="full" class="tick">Criteria</ion-button>


  <div class="table-container">
    <table class="custom-table">
      
      <thead>
        <tr class="tableheadingcss">
          <th>Exam</th>
          <th>VMD</th>
          <th>Sales</th>
        </tr>
      </thead>

      <tbody class="tablebodycss">
        <tr>
          <td>5%</td>
          <td>15%</td>
          <td>80%</td>
        </tr>
      </tbody>
    </table>
  </div>

  

</ion-content> -->

<ion-content class="main-content dark light" >
  <ng-container *ngIf="isRoleLoaded">
  <div *ngIf="roleId == '3'; else noPermission">
    <div class="heading-div">
      <h6 class="home-headings">Promoter KPI</h6>
    </div>
    <ion-grid class="pprofile-grid">
      <ion-row class="pprofile-details-row">
        <ion-col size="4" class="ddetail-heading">
          <p>Name:</p>
        </ion-col>
        <ion-col size="8" class="ddetail-text">
          {{ userData.firstName }} {{ userData.lastName }}
        </ion-col>
      </ion-row>

      <ion-row class="pprofile-details-row">
        <ion-col size="4" class="ddetail-heading">
          <p>Retailer:</p>
        </ion-col>
        <ion-col size="8" class="ddetail-text">
          {{ userData.retailerName }}
        </ion-col>
      </ion-row>

      <ion-row class="pprofile-details-row">
        <ion-col size="4" class="ddetail-heading">
          <p>Store:</p>
        </ion-col>
        <ion-col size="8" class="ddetail-text">
          {{ userData.storeName }}
        </ion-col>
      </ion-row>

      <ion-row class="pprofile-details-row">
        <ion-col size="4" class="ddetail-heading">
          <p>Category:</p>
        </ion-col>
        <ion-col size="8" class="ddetail-text">
          {{ userData.categories }}
        </ion-col>
      </ion-row>

      <ion-row class="pprofile-details-row">
        <ion-col size="4" class="ddetail-heading">
          <p>Country:</p>
        </ion-col>
        <ion-col size="8" class="ddetail-text">
          {{ userData.country }}
        </ion-col>
      </ion-row>
    </ion-grid>

    <ion-grid>
      <ion-row>
        <ion-col size="12" class="ion-text-center"> <!-- Centering the button -->
          <ion-button expand="full" class="tick" (click)="openMonthSelect()">
            {{ selectedMonth ? selectedMonth : 'Select Month' }}
          </ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>

    <!-- Hidden ion-select component with popover interface for month selection -->
    <ion-select #monthSelect interface="popover" placeholder="Select Month" (ionChange)="onMonthSelect($event)"
      label="Select Month:" class="mine" multiple="true">
      <ion-select-option *ngFor="let month of months" [value]="month.value">{{ month.name }}</ion-select-option>
    </ion-select>

    <!-- First Table -->
    <!-- <div class="table-container">
    <table class="custom-table">
  
      <thead>
        <tr class="tableheadingcss">
          <th>Mon</th>
          <th>Exam</th>
          <th>VMD</th>
          <th>Sales</th>
          <th>TTL</th>
        </tr>
      </thead>

      <tbody class="tablebodycss">
        <tr>
          <td>Apr</td>
          <td>100%</td>
          <td>15</td>
          <td>125%</td>
          <td>120%</td>
        </tr>
        <tr>
          <td>May</td>
          <td>90%</td>
          <td>13.5</td>
          <td>80%</td>
          <td>98%</td>
        </tr>
        <tr>
          <td>Jun</td>
          <td>72%</td>
          <td>10.5</td>
          <td>70%</td>
          <td>87.5%</td>
        </tr>
        <tr>
          <td>TTL</td>
          <td></td>
          <td></td>
          <td></td>
          <td>101.8%</td>
        </tr>
      </tbody>
    </table>
  </div> -->

    <!-- KPI Scores Table -->
    <div class="table-container">
      <table class="custom-table">
        <!-- Table Header -->
        <thead>
          <tr class="tableheadingcss">
            <th>Mon</th>
            <th>Exam</th>
            <th>VMD</th>
            <th>Sales</th>
            <th>TTL</th>
          </tr>
        </thead>

        <tbody class="tablebodycss">
          <tr *ngFor="let score of kpiScores">
            <td>{{ getMonthName(score.month) }}</td>
            <td>{{ score.exam_weight !== null && score.exam_weight !== undefined ? score.exam_weight + '%' : 'N/A' }}
            </td>
            <td>{{ score.vmd_weight !== null && score.vmd_weight !== undefined ? score.vmd_weight : 'N/A' }}</td>
            <td>{{ score.sales_weight !== null && score.sales_weight !== undefined ? score.sales_weight + '%' : 'N/A' }}
            </td>
            <td>{{ score.ttl_ranking !== null && score.ttl_ranking !== undefined ? score.ttl_ranking + '%' : 'N/A' }}
            </td>
          </tr>
          <tr>
            <td>TTL</td>
            <td></td>
            <td></td>
            <td></td>
            <td><strong>{{ totalTtlPercentage }}%</strong></td>
            <!-- You can replace this with your total calculation -->
          </tr>
        </tbody>


      </table>
    </div>

    <!-- Criteria Button -->
    <ion-button expand="full" class="tick">Criteria</ion-button>

    <!-- Second Table -->
   
    <div class="table-container">
      <table class="custom-table">
        <!-- Table Header -->
        <thead>
          <tr class="tableheadingcss">
            <th>Exam</th>
            <th>VMD</th>
            <th>Sales</th>
          </tr>
        </thead>

        <tbody class="tablebodycss">
          <tr>
            <td>5%</td>
            <td>15%</td>
            <td>80%</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  </ng-container>

  <ng-template #noPermission>
    <div class="no-permission">
      <ion-row>
        <ion-col>
          <div class="notification-message">
            Promoter Kpi module access is not given to your user role.
            Please contact management for assistance.
          </div>
        </ion-col>
      </ion-row>
    </div>
  </ng-template>

  <!-- <ion-button class="back-button-bottom-right" color="dark" [routerLink]="['/promoter-kpi']">
    <ion-icon name="chevron-back-outline"></ion-icon>
  </ion-button> -->
</ion-content>
<app-footer></app-footer>